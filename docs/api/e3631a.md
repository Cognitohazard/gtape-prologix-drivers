# AgilentE3631A

Triple Output DC Power Supply - 6V/5A, +25V/1A, -25V/1A.

## Import

```python
from gtape_prologix_drivers import AgilentE3631A
```

## Constructor

```python
AgilentE3631A(adapter)
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `adapter` | PrologixAdapter | Connected adapter instance |

## Channel Constants

| Constant | Value | Description | Voltage Range | Current Range |
|----------|-------|-------------|---------------|---------------|
| `AgilentE3631A.P6V` | 1 | +6V channel | 0 to 6V | 0 to 5A |
| `AgilentE3631A.P25V` | 2 | +25V channel | 0 to 25V | 0 to 1A |
| `AgilentE3631A.N25V` | 3 | -25V channel | 0 to -25V | 0 to 1A |

The `CHANNEL_SPECS` dict maps each channel to `(voltage_max, current_max)` tuples.

---

## Quick Setup

### configure_output

```python
psu.configure_output(channel: str, voltage: float, current_limit: float) -> None
```

Configure a channel's voltage and current limit.

| Parameter | Type | Description |
|-----------|------|-------------|
| `channel` | str | Channel constant (P6V, P25V, N25V) |
| `voltage` | float | Output voltage in volts |
| `current_limit` | float | Current limit in amps |

**Example:**
```python
psu.configure_output(AgilentE3631A.P6V, voltage=5.0, current_limit=1.0)
```

---

## Output Control

### enable_output

```python
psu.enable_output(enable: bool) -> None
```

Enable or disable all outputs.

| Parameter | Type | Description |
|-----------|------|-------------|
| `enable` | bool | True to enable, False to disable |

---

## Channel Selection

### select_channel

```python
psu.select_channel(channel: str) -> None
```

Select channel for subsequent voltage/current commands.

| Parameter | Type | Description |
|-----------|------|-------------|
| `channel` | str | Channel constant |

---

## Voltage Control

### set_voltage

```python
psu.set_voltage(voltage: float) -> None
```

Set voltage on currently selected channel.

| Parameter | Type | Description |
|-----------|------|-------------|
| `voltage` | float | Voltage in volts |

---

### get_voltage_setpoint

```python
psu.get_voltage_setpoint() -> float
```

Query voltage setpoint on current channel.

**Returns:** Voltage setpoint in volts

---

## Current Control

### set_current_limit

```python
psu.set_current_limit(current: float) -> None
```

Set current limit on currently selected channel.

| Parameter | Type | Description |
|-----------|------|-------------|
| `current` | float | Current limit in amps |

---

### get_current_limit

```python
psu.get_current_limit() -> float
```

Query current limit on current channel.

**Returns:** Current limit in amps

---

## Measurements

### measure_voltage

```python
psu.measure_voltage(channel: int | None = None) -> float
```

Measure actual output voltage.

| Parameter | Type | Description |
|-----------|------|-------------|
| `channel` | int \| None | Channel to measure (P6V=1, P25V=2, N25V=3). If None, uses currently selected channel. |

**Returns:** Measured voltage in volts

---

### measure_current

```python
psu.measure_current(channel: int | None = None) -> float
```

Measure actual output current.

| Parameter | Type | Description |
|-----------|------|-------------|
| `channel` | int \| None | Channel to measure. If None, uses currently selected channel. |

**Returns:** Measured current in amps

---

## Utility Methods

### reset

```python
psu.reset() -> None
```

Reset to default settings (outputs disabled, 0V/0A).

---

### check_errors

```python
psu.check_errors() -> str
```

Query PSU for errors.

**Returns:** Error string ("+0,No error" if none)

---

## Complete Example

```python
from gtape_prologix_drivers import PrologixAdapter, AgilentE3631A

adapter = PrologixAdapter(port="COM4", gpib_address=5)
psu = AgilentE3631A(adapter)

# Configure and enable
psu.configure_output(AgilentE3631A.P6V, voltage=5.0, current_limit=1.0)
psu.enable_output(True)

# Monitor output
psu.select_channel(AgilentE3631A.P6V)
voltage = psu.measure_voltage()
current = psu.measure_current()
print(f"Output: {voltage:.3f} V, {current:.4f} A")

# Adjust voltage
psu.set_voltage(3.3)

# Disable when done
psu.enable_output(False)
adapter.close()
```

## Safety Notes

1. **Always set current limits** before enabling output
2. **Disable output** before changing channels or disconnecting loads
3. The PSU has **overvoltage and overcurrent protection** - check status if output shuts off unexpectedly
