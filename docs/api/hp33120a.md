# HP33120A

Arbitrary Waveform Generator - 15MHz, 12-bit DAC, 8-16000 points.

## Import

```python
from gtape_prologix_drivers.instruments.hp33120a import HP33120A
```

## Constructor

```python
HP33120A(adapter)
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `adapter` | PrologixAdapter | Connected adapter instance |

---

## Arbitrary Waveform

### setup_arbitrary_waveform

```python
awg.setup_arbitrary_waveform(
    waveform: np.ndarray,
    name: str = "VOLATILE",
    frequency: float = 1000,
    voltage: float = 1.0,
    offset: float = 0.0,
    load: int = 50
) -> None
```

Upload and configure an arbitrary waveform.

| Parameter | Type | Description |
|-----------|------|-------------|
| `waveform` | np.ndarray | Waveform data (0-2047 range, uint16) |
| `name` | str | Waveform name (max 8 chars, or "VOLATILE") |
| `frequency` | float | Output frequency in Hz |
| `voltage` | float | Peak-to-peak voltage in volts |
| `offset` | float | DC offset in volts |
| `load` | int | Load impedance (50 or "INF") |

**Waveform requirements:**
- Values: 0-2047 (12-bit DAC, mid-scale = 1024)
- Length: 8-16000 points
- Type: `numpy.uint16`

---

### upload_waveform

```python
awg.upload_waveform(waveform: np.ndarray, name: str = "VOLATILE") -> None
```

Upload waveform data without configuring output.

| Parameter | Type | Description |
|-----------|------|-------------|
| `waveform` | np.ndarray | Waveform data (0-2047, uint16) |
| `name` | str | Storage name |

---

## Output Control

### set_output

```python
awg.set_output(enable: bool) -> None
```

Enable or disable output.

| Parameter | Type | Description |
|-----------|------|-------------|
| `enable` | bool | True to enable |

---

### set_frequency

```python
awg.set_frequency(frequency: float) -> None
```

Set output frequency.

| Parameter | Type | Description |
|-----------|------|-------------|
| `frequency` | float | Frequency in Hz |

---

### set_voltage

```python
awg.set_voltage(voltage: float) -> None
```

Set peak-to-peak voltage.

| Parameter | Type | Description |
|-----------|------|-------------|
| `voltage` | float | Vpp in volts |

---

### set_offset

```python
awg.set_offset(offset: float) -> None
```

Set DC offset.

| Parameter | Type | Description |
|-----------|------|-------------|
| `offset` | float | Offset in volts |

---

## Standard Waveforms

### set_function

```python
awg.set_function(function: str) -> None
```

Set standard function.

| Parameter | Type | Description |
|-----------|------|-------------|
| `function` | str | "SIN", "SQU", "TRI", "RAMP", "NOIS", "USER" |

---

## Utility Methods

### get_id

```python
awg.get_id() -> str
```

Query instrument identification.

---

### reset

```python
awg.reset() -> None
```

Reset to default settings.

---

## Complete Example

```python
import numpy as np
from gtape_prologix_drivers import PrologixAdapter
from gtape_prologix_drivers.instruments.hp33120a import HP33120A

adapter = PrologixAdapter(port="COM4", gpib_address=10)
awg = HP33120A(adapter)

# Create a custom waveform (sine with harmonics)
t = np.linspace(0, 2*np.pi, 1000)
wave = np.sin(t) + 0.3*np.sin(3*t) + 0.1*np.sin(5*t)

# Scale to 0-2047 range
wave_scaled = ((wave + 1) / 2 * 2047).astype(np.uint16)

# Upload and configure
awg.setup_arbitrary_waveform(
    waveform=wave_scaled,
    name="HARMONIC",
    frequency=1000,    # 1 kHz
    voltage=2.0,       # 2 Vpp
    offset=0.0,
    load=50            # 50Î© load
)

# Output is automatically enabled
# To disable:
awg.set_output(False)

adapter.close()
```

## Waveform Tips

1. **Mid-scale (1024)** = zero voltage when offset=0
2. **0** = negative peak, **2047** = positive peak
3. Use **numpy** for efficient waveform generation
4. Longer waveforms = better resolution but slower update rate
