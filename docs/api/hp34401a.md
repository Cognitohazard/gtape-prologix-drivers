# HP34401A

6.5 Digit Digital Multimeter - DC/AC voltage and current, 2/4-wire resistance.

## Import

```python
from gtape_prologix_drivers import HP34401A
```

## Constructor

```python
HP34401A(adapter)
```

| Parameter | Type | Description |
|-----------|------|-------------|
| `adapter` | PrologixAdapter | Connected adapter instance |

---

## Quick Measurements

These methods configure and measure in a single call.

### measure_voltage

```python
dmm.measure_voltage(ac: bool = False, range_volts: float = None) -> float
```

Measure voltage.

| Parameter | Type | Description |
|-----------|------|-------------|
| `ac` | bool | True for AC, False for DC (default) |
| `range_volts` | float \| None | Manual range, or None for auto |

**Returns:** Voltage in volts

**Ranges:** 0.1, 1, 10, 100, 1000 V

---

### measure_current

```python
dmm.measure_current(ac: bool = False, range_amps: float = None) -> float
```

Measure current.

| Parameter | Type | Description |
|-----------|------|-------------|
| `ac` | bool | True for AC, False for DC (default) |
| `range_amps` | float \| None | Manual range, or None for auto |

**Returns:** Current in amps

**Ranges:** 0.01, 0.1, 1, 3 A

---

### measure_resistance

```python
dmm.measure_resistance(four_wire: bool = False, range_ohms: float = None) -> float
```

Measure resistance.

| Parameter | Type | Description |
|-----------|------|-------------|
| `four_wire` | bool | True for 4-wire, False for 2-wire (default) |
| `range_ohms` | float \| None | Manual range, or None for auto |

**Returns:** Resistance in ohms

**Ranges:** 100, 1k, 10k, 100k, 1M, 10M, 100M Ω

---

## Configure + Read (Faster for Repeated Measurements)

### configure_dc_voltage

```python
dmm.configure_dc_voltage(range_volts: float = None, resolution: float = None) -> None
```

Configure for DC voltage measurement.

| Parameter | Type | Description |
|-----------|------|-------------|
| `range_volts` | float \| None | Range (None for auto) |
| `resolution` | float \| None | Resolution in volts |

---

### configure_ac_voltage

```python
dmm.configure_ac_voltage(range_volts: float = None, resolution: float = None) -> None
```

Configure for AC voltage measurement.

---

### configure_dc_current

```python
dmm.configure_dc_current(range_amps: float = None, resolution: float = None) -> None
```

Configure for DC current measurement.

---

### configure_ac_current

```python
dmm.configure_ac_current(range_amps: float = None, resolution: float = None) -> None
```

Configure for AC current measurement.

---

### configure_resistance

```python
dmm.configure_resistance(range_ohms: float = None, resolution: float = None) -> None
```

Configure for 2-wire resistance measurement.

---

### configure_resistance_4wire

```python
dmm.configure_resistance_4wire(range_ohms: float = None, resolution: float = None) -> None
```

Configure for 4-wire resistance measurement.

---

### read

```python
dmm.read() -> float
```

Take a reading using the current configuration.

**Returns:** Measurement value

**Example:**
```python
# Configure once
dmm.configure_dc_voltage(range_volts=10, resolution=0.0001)

# Read many times (fast)
for i in range(100):
    voltage = dmm.read()
    print(f"Reading {i}: {voltage:.6f} V")
```

---

## Utility Methods

### get_id

```python
dmm.get_id() -> str
```

Query instrument identification.

---

### reset

```python
dmm.reset() -> None
```

Reset to default settings (DC voltage, autorange).

---

### check_errors

```python
dmm.check_errors() -> str
```

Query multimeter for errors.

**Returns:** Error string ("+0,No error" if none)

---

## Integration Time (NPLC)

### set_nplc

```python
dmm.set_nplc(nplc: float = 1) -> None
```

Set integration time in power line cycles.

| Parameter | Type | Description |
|-----------|------|-------------|
| `nplc` | float | Valid values: 0.02, 0.2, 1, 10, 100 |

Lower NPLC = faster but noisier. NPLC 1 is a good balance (~20ms at 50Hz).

---

### get_nplc

```python
dmm.get_nplc() -> float
```

Query current NPLC setting.

---

## Frequency Measurement

### measure_frequency

```python
dmm.measure_frequency(range_volts: float | None = None) -> float
```

Measure signal frequency.

| Parameter | Type | Description |
|-----------|------|-------------|
| `range_volts` | float \| None | Expected voltage range for input (None for auto) |

**Returns:** Frequency in Hz

---

## Complete Example

```python
from gtape_prologix_drivers import PrologixAdapter, HP34401A

adapter = PrologixAdapter(port="COM4", gpib_address=22)
dmm = HP34401A(adapter)

# Quick measurements
voltage = dmm.measure_voltage(range_volts=10)
current = dmm.measure_current(range_amps=1)
resistance = dmm.measure_resistance(four_wire=True, range_ohms=1000)

print(f"Voltage: {voltage:.6f} V")
print(f"Current: {current:.6f} A")
print(f"Resistance: {resistance:.2f} Ω")

# Fast repeated measurements
dmm.configure_dc_voltage(range_volts=10)
readings = [dmm.read() for _ in range(10)]
print(f"Average: {sum(readings)/len(readings):.6f} V")

adapter.close()
```

## Performance Tips

1. **Use fixed range** instead of auto-range for faster measurements
2. **Configure once, read many** times for repeated measurements
3. **Lower resolution** = faster measurements (but less precision)
